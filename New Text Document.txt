php

namespace AppHttpControllersadmin2Controller;

use AppHttpControllersController;
use AppHttpRequestsadminUpdateStoreUserRequest;
use AppHttpRequestsadminUpdateUserReques;
use AppModelsadminPermission;
use AppModelsUser;
use IlluminateHttpRequest;
use IlluminateSupportFacadesHash;
use IlluminateSupportFacadesStorage;

class userController extends Controller
{
    
      Display a listing of the resource.
     
      @return IlluminateHttpResponse
     
    public function index()
    {
        $users=UserorderBy('name', 'ASC')-paginate(7);
        return view('admin2.pages.edition.user.index')
            -with('users',$users);
    }

    
      Show the form for creating a new resource.
     
      @return IlluminateHttpResponse
     
    public function create()
    {
        return view('admin2.pages.edition.user.add')
            -with('permissions',Permissionget()-all());
    }

    
      Store a newly created resource in storage.
     
      @param  IlluminateHttpRequest  $request
      @return IlluminateHttpResponse
     
    public function store(UpdateStoreUserRequest $request)
    {
        $user=new User();
         Usercreate([
            'name' = $request-name,
            'email' = $request-email,
            'user_name' = $request-user_name,
            'password' = Hashmake($request-password),
            'permission' =$request-permission,
        ]);
        $user-name=$request-name;
        $user-user_name=$request-user_name;
        $user-email=$request-email;
        $user-password=Hashmake($request-password);
        
        return redirect()-route('admin-panel-user.index');
    }

    
      Display the specified resource.
     
      @param  int  $id
      @return IlluminateHttpResponse
     
    public function show($id)
    {
        
        $user=Userfind($id);
        $status=false;

        return view('admin2.pages.edition.user.show')
            -with('user',$user)
            -with('collapse', $status);
    }

    
      Show the form for editing the specified resource.
     
      @param  int  $id
      @return IlluminateHttpResponse
     
    public function edit($id)
    {
        
    }
    
    
      Update the specified resource in storage.
     
      @param  IlluminateHttpRequest  $request
      @param  int  $id
      @return IlluminateHttpResponse
     
    public function update(Request $request, $id)
    {
        
        $user=Userfind($id);
        if(!$user){

            return back();
        }
           
           $this-validate($request,[
            
            'name' = ['required', 'string', 'max255'],
            'user_name' = ['required', 'string', 'max255'],
            'email' = ['required', 'string', 'email', 'max255',
                        'uniqueusers,email,'.$id],
            'password'='samepassword_confirmation',
                        
            
        ]);

        $user-name=$request-name;
        $user-user_name=$request-user_name;
        $user-email=$request-email;

        if($request-password){
            $user-password=Hashmake($request-password);
        }
        
        if($request-image && $request-image-isValid()){
            if (Storageexists($user-profile_photo_path))
                Storagedelete($user-profile_photo_path);
            
            $imagePath=$request-image-store('profile');
            $user-profile_photo_path=$imagePath;
        }
        $user-update();
        $status=true;
        return view('admin2.pages.edition.user.show')
            -with('user', Userfind($id))
            -with('collapse', $status);
    }

    
      Remove the specified resource from storage.
     
      @param  int  $id
      @return IlluminateHttpResponse
     
    public function destroy($id)
    {
        $user=Userfind($id);
        if (!$user) {
            return back();
        }
        
        if($user-profile_photo_path && Storageexists($user-profile_photo_path)){
            Storagedelete($user-profile_photo_pat);
        }
        $user-delete();
        return redirect()-route('admin-panel-user.index');
    }
}
----------------------------------------------------------------------------------------------------------------
@extends('admin2.layouts.master')@section('title', 'Projeniy|| dashboard')

@section('main-content')
    <div class="container-fluid">

        <!-- Content Row -->
        <div class="row justify-content-center">
            <div class="col-xl-8 col-md-6 mb-4">
                <div class="card border-bottom-dark shadow h-100 py-2">

                    <div class=" card-header text-center ">
                        
                           
                         <h3 class="text-dark " >{{ __('Perfil do Usuario') }}</h3>
                        
                    </div>
                    <div class="card-body">
                        
                        <div class="row mb-1 justify-content-center text-center">
                            <img class="card-img-top rounded-circle" src="{{url('storage',$user->profile_photo_path)}}" 
                            alt="Photo" style=" height:10%; width: 20%; ">
                        </div>
                        
                        <div class="row mb-1 justify-content-center ">
                            

                            <div class="">
                                <h2>{{$user->name}}</h2> 
                            </div>
                        </div>
                        <div class="row mb-1 justify-content-center ">
                           
                            <div class="">
                                <h5>{{$user->email}} </h5>
                            </div>
                        </div>
                        <hr>
                        
                        @if ($collapse==true)
                            <div class="collapse.show" id="collapseExample">
                                
                        @else
                                
                            <p class="text-center"  >
                                
                                <a class="btn btn-dark" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample" onclick="function hi(){$collapse=true};hi()">
                                Editar
                                </a>
                            </p>    
                            <div class="collapse" id="collapseExample">
                        @endif
                            <div class="card-body">
                                <form method="POST" action="{{ route('admin-panel-user.update',$user->id) }}" enctype="multipart/form-data">
                                    @csrf
                                    @method('PUT')
                                    <div class="row mb-3">
                                        <label for="name" class="col-md-4 col-form-label text-md-right">{{ __('Nome Completo') }}</label>
            
                                        <div class="col-md-6">
                                            <input id="name" type="text" class="form-control @error('name') is-invalid @enderror" name="name" value="{{$user->name}}" required autocomplete="name" autofocus>
            
                                            @error('name')
                                                <span class="invalid-feedback" role="alert">
                                                    <strong>{{ $message }}</strong>
                                                </span>
                                            @enderror
                                        </div>
                                    </div>                                
                                    
            
                                    <div class="row mb-3">
                                        <label for="email" class="col-md-4 col-form-label text-md-right">{{ __('E-Mail') }}</label>
            
                                        <div class="col-md-6">
                                            <input id="email" type="email" class="form-control @error('email') is-invalid @enderror" name="email" value="{{$user->email}}" required autocomplete="email">
            
                                            @error('email')
                                                <span class="invalid-feedback" role="alert">
                                                    <strong>{{ $message }}</strong>
                                                </span>
                                            @enderror
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="user_name" class="col-md-4 col-form-label text-md-right">{{ __('Username') }}</label>
            
                                        <div class="col-md-6">
                                            <input id="user_name" type="text" class="form-control @error('user_name') is-invalid @enderror" name="user_name" value="{{$user->user_name}}" required autocomplete="user_name" >
            
                                            @error('user_name')
                                                <span class="invalid-feedback" role="alert">
                                                    <strong>{{ $message }}</strong>
                                                </span>
                                            @enderror
                                        </div>
                                    </div>
            
                                    <div class="row mb-3">
                                        <label for="password" class="col-md-4 col-form-label text-md-right">{{ __('Password') }}</label>
            
                                        <div class="col-md-6">
                                            <input id="password" type="password" class="form-control @error('password') is-invalid @enderror" name="password" autocomplete="new-password">
            
                                            @error('password')
                                                <span class="invalid-feedback" role="alert">
                                                    <strong>{{ $message }}</strong>
                                                </span>
                                            @enderror
                                        </div>
                                    </div>
            
                                    <div class="row mb-3">
                                        <label for="password-confirm" class="col-md-4 col-form-label text-md-right">{{ __('Confirm Password') }}</label>
            
                                        <div class="col-md-6">
                                            <input id="password-confirm" type="password" class="form-control" name="password_confirmation" autocomplete="new-password">
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <label for="image" class="col-md-4 col-form-label text-md-right">{{ __('Imagem') }}</label>
            
                                        <div class="col-md-2">
                                            <input id="image" type="file" class="form-control @error('image') is-invalid @enderror" name="image"  >
            
                                            @error('image')
                                                <span class="invalid-feedback" role="alert">
                                                    <strong>{{ $message }}</strong>
                                                </span>
                                            @enderror
                                        </div>
                                    </div>
            
                                    <div class="row mb-0">
                                        <div class="col-md-6 offset-md-4">
                                            <button type="submit" class="btn btn-primary">
                                                {{ __('Salvar') }}
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                          </div>

                    </div>



                </div>

            </div>
        </div>
    </div>
    <style>
        #campos{
            text-align:justify;
            margin-bottom: 5px;
        }
        #campos h6{
            font-size:15pt;
            font-weight: bold;
        }
        #campos span{
            font-size:13pt;
            font-weight: bold;
        }
        #campo{
            font-size:15pt;
            font-weight: bold;
            margin-bottom: 4rem;
            color:red;
        }
        #campos #files span{
            font-size:10pt;
        }
    </style>
@endsection
